<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlist</title>
    <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
    <!--<link rel="stylesheet" href="/css/style.css">-->
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/chart.css">
    <link rel="stylesheet" type="text/css" href="/css/listeningHistory.css"/>

    <style>

        #searchMusic {
            border: 1px solid white;  /* ì™¸ê°ì„  í•˜ì–€ìƒ‰ 1px */
            color: white;  /* í…ìŠ¤íŠ¸ ìƒ‰ í•˜ì–€ìƒ‰ */
            font-size: 14px;  /* í…ìŠ¤íŠ¸ í¬ê¸° 14px */
            padding: 5px;  /* ì ë‹¹í•œ íŒ¨ë”© ì¶”ê°€ (ì„ íƒ ì‚¬í•­) */
            background-color: transparent;  /* ë°°ê²½ íˆ¬ëª… */
        }

        /* ì „ì²´ ë ˆì´ì•„ì›ƒ */
        body {

            background-color: #121212;
            color: #FFFFFF;
            font-family: Arial, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            scrollbar-width: thin; /* ìŠ¤í¬ë¡¤ë°” ë‘ê»˜ */
            scrollbar-color: #888 #f1f1f1; /* ìŠ¤í¬ë¡¤ë°”ì™€ íŠ¸ë™ ìƒ‰ìƒ */
        }

        /* ì»¨í…Œì´ë„ˆ ë°•ìŠ¤ */
        .container {
            border: 2px solid lightgray;
            width: 900px;
            height: 650px;
            background-color: #181818;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 15px #5bb872; /* 0ì€ px ìƒëµê°€ëŠ¥*/
        }

        form{
            display: flex;
            background-color: #425432;
        }

        /* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */
        .sidebar {
            width: 60%;
            padding: 20px 20px 20px 20px;
            align-items: center;
            background-color: rgba(42, 59, 31, 0.9);
        }

        .sidebar img {
            width: 50px;
            height: 50px;
            border-radius: 5px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            cursor: pointer;
        }

        .playlist-item img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            margin-right: 10px;
        }

        .playlist-item span {
            font-size: 16px;
            color: ghostwhite;
        }

        /* ìŒì•… ëª©ë¡ì´ ë„˜ì–´ê°€ë©´ ìŠ¤í¬ë¡¤ë°” ìƒì„± */
        #list {
            max-height: 600px; /* ìµœëŒ€ ë†’ì´ë¥¼ ì„¤ì • */
            overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ë°” í‘œì‹œ */
            padding-right: 10px; /* ìŠ¤í¬ë¡¤ë°”ì™€ ë‚´ìš© ì‚¬ì´ì˜ ê°„ê²© ì¡°ì ˆ */
            border-radius: 10px; /* íŠ¸ë™ì˜ ë‘¥ê·¼ ëª¨ì„œë¦¬ */
        }


        /* ì˜¤ë¥¸ìª½ ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            width: 65%;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        /* ì»¤ë²„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° */
        #coverPreview {
            width: 100px;
            height: 100px;
            background-color: rgba(194, 181, 106, 0.8);
            border-radius: 10px;
            object-fit: cover; /* ì´ë¯¸ì§€ ë¹„ìœ¨ì— ë§ì¶° ìë¥´ê¸° */
            margin-bottom: 20px; /* í•˜ë‹¨ ì—¬ë°± */
            border: 3px solid ghostwhite;
            display: block; /* ì´ë¯¸ì§€ê°€ ì•ˆ ë³´ì´ë©´ ìˆ¨ê¸°ê¸° */
            /*background-image: url('./default.jpg'); !* ê¸°ë³¸ ì´ë¯¸ì§€ *!*/
        }

        /* í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì •ë³´ ì…ë ¥ */
        .playlist-info {
            display: flex;
            flex-direction: column;
        }

        .playlist-info label {
            color: #B3B3B3;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .playlist-info input[type="text"],
        .playlist-info input[type="file"] {
            padding: 8px;
            border: 1px solid #3e3e3e;
            border-radius: 5px;
            background-color: #121212;
            color: #fff;
            margin-bottom: 15px;
        }

        /* ì¶”ì²œ ë…¸ë˜ ë¦¬ìŠ¤íŠ¸ */
        #musicList {
            flex-grow: 1;
            overflow-x: hidden; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ ìˆ¨ê¸°ê¸° */
        }

        .chartBox {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #5e7550;
        }

        .chartBox img {
            width: 50px;
            height: 50px;
            border-radius: 5px;
        }

        .song-title {
            border: none;
            background: transparent;
            cursor: pointer;
        }

        /* ìŒì•…ì°¨íŠ¸ ì•¨ë²” ì •ë³´ í¬ê¸° */
        .song-info {
            flex-grow: 1;
            margin-left: 10px;
        }

        .song-info .title {
            font-weight: bold;
            color: #FFFFFF;
        }

        .song-info .artist {
            font-size: 15px;
            color: whitesmoke;
        }

        /* í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì•¨ë²” ì •ë³´ í¬ê¸° */
        .song-pinfo {
            flex-grow: 1;
            margin-left: 10px;
            display: flex;
            flex-direction: column; /* ì„¸ë¡œë¡œ ì •ë ¬ */
        }

        .song-pinfo .title {
            font-weight: bold;
            font-size: 12px;
            color: #FFFFFF;
        }

        .song-pinfo .artist {
            font-size: 8px;
            color: whitesmoke;
        }

        /* í”Œë ˆì´ì–´ ë²„íŠ¼ */
        .actions {
            display: flex;
            gap: 10px;
        }

        .actions button {
            background-color: transparent; /* ë²„íŠ¼ ë°°ê²½ íˆ¬ëª… ì„¤ì • */
            border: none; /* ë²„íŠ¼ í…Œë‘ë¦¬ ì œê±° */
            padding: 8px; /* ë²„íŠ¼ ì˜ì—­ í™•ë³´ */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .actions button img {
            background-color: transparent; /* ë°°ê²½ íˆ¬ëª… ì„¤ì • */
            width: 17px;
            height: 17px;
            cursor: pointer;
        }

        /* ëª©ë¡ì—ì„œ ì œê±° */
        .remove-song {
            background-color: transparent;
            border: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .remove-song img {
            background-color: transparent; /* ë°°ê²½ íˆ¬ëª… ì„¤ì • */
            width: 16px !important; /* song-itemê³¼ ê²¹ì³ì„œ ìš°ì„ ìˆœìœ„ ì‚¬ìš©*/
            height: 16px !important;
            cursor: pointer;
            margin-left: 10px; /* ì´ë¯¸ì§€ì™€ ë‹¤ë¥¸ í•­ëª© ì‚¬ì´ ê°„ê²© ì¶”ê°€ */
        }

        /* ì•¨ë²” ì»¤ë²„ ì´ë¯¸ì§€ì™€ ì œëª©ì´ í¬í•¨ëœ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .song-item {
            display: flex;
            align-items: center;
            padding: 2px 10px 15px 10px;
            margin-bottom: 20px; /* ê° í•­ëª© ì‚¬ì´ ì—¬ë°± ì¶”ê°€ */
            border-bottom: 1px solid #3e6241;
        }

        .song-item img {
            width: 45px; /* ì•¨ë²” ì»¤ë²„ ì´ë¯¸ì§€ í¬ê¸° */
            height: 45px;
            border-radius: 5px; /* ì´ë¯¸ì§€ í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
            margin-right: 15px; /* ì´ë¯¸ì§€ì™€ ì œëª© ì‚¬ì´ ê°„ê²© ì¶”ê°€ */
        }

        /* ë§ˆì§€ë§‰ song-item ì•„ë˜ì— êµ¬ë¶„ì„  ì œê±° */
        .song-item:last-child {
            border-bottom: none;
        }

        /* ì €ì¥ ë²„íŠ¼ */
        .save-button {
            padding: 5px;
            background-color: #5bb872;
            border: none;
            border-radius: 5px;
            color: #FFFFFF;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 15%;
        }

        .save-button:hover {
            background-color: #3c9d51;
        }

        #chartTitle {
            color: #ff6f6f;
            font-size: 18px;
            font-weight: bold;
        }

        .btn-over {
            background-color: transparent;
            border: none;
            outline: none;
            box-shadow: none;
            padding: 0;
            margin: 10px;
            font-size: 18px;
            color: #fff;
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ í¬ì¸í„° */
            transition: transform 0.1s ease, opacity 0.1s ease; /* ëˆŒë¦¬ëŠ” íš¨ê³¼ì™€ íˆ¬ëª…ë„ ë³€í™” */
        }

        .btn-over:hover {
            opacity: 0.8; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ íˆ¬ëª…ë„ë¥¼ ì¡°ê¸ˆ ë‚®ì¶”ê¸° */
        }

        .btn-over:active {
            transform: scale(0.95); /* ë²„íŠ¼ í´ë¦­ ì‹œ í¬ê¸° ì¶•ì†Œ */
        }

        /* ëª¨ë‹¬ì˜ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .modal {
            position: fixed; /* í™”ë©´ì— ê³ ì • */
            z-index: 1; /* ë‹¤ë¥¸ ìš”ì†Œë“¤ ìœ„ì— ì˜¬ë¦¼ */
            top: 50%; /* í™”ë©´ ì¤‘ì•™ì— ìœ„ì¹˜ */
            left: 50%; /* í™”ë©´ ì¤‘ì•™ì— ìœ„ì¹˜ */
            transform: translate(-50%, -50%); /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ë³€í™˜ */
            border-radius: 8px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
            width: 100%;
            height: 100%;
            background-color: transparent; /* ë°˜íˆ¬ëª… ê²€ì • ë°°ê²½ */
            display: flex; /* ê°€ìš´ë° ì •ë ¬ì„ ìœ„í•´ í”Œë ‰ìŠ¤ ì‚¬ìš© */
            align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
            justify-content: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        }

        /* ëª¨ë‹¬ ë‚´ìš© ìŠ¤íƒ€ì¼ */
        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 350px;
            position: relative;
        }

        /* ë‹«ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 20px;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* ë’¤ë¡œê°€ê¸° */
        #backButton {
            position: fixed;
            top: 150px;   /* ìƒë‹¨ì—ì„œ 20px */
            left: 70px;  /* ì™¼ìª½ì—ì„œ 20px */
            z-index: 1000; /* ë‹¤ë¥¸ ìš”ì†Œë“¤ë³´ë‹¤ ìœ„ì— ìœ„ì¹˜í•˜ë„ë¡ ì„¤ì • */
            background-color: transparent;
            border: none;
            padding: 0;
        }
        #backButton img {
            width: 30px;
            height: 30px;
            cursor: pointer;
        }

    </style>
</head>

<body>
<!-- í—¤ë” -->
<div th:replace="~{header.html}"></div>


<div class="container">
    <form action="/playList" method="POST" enctype="multipart/form-data">
        <div class="sidebar" id="">
            <div id="list"></div>
        </div>
        <button id="backButton">
            <img src="/img/back.png" style="cursor: pointer; width: 30px;" alt="ë’¤ë¡œê°€ê¸°">
        </button>

        <div class="main-content">

            <!-- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì •ë³´ ì…ë ¥ -->
            <div class="playlist-info">
                <div style="display: flex; justify-content: center;">
                    <!-- ì»¤ë²„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                    <img id="coverPreview" alt="">
                    <div style="margin-top: 5px;">
                        <button class="btn-over" onclick="openModal()">â˜°</button>
                        <br/>
                        <span style="paFdding: 10px;">&nbsp;&nbsp;&nbsp;[[${session.loginId}]]</span>

                        <!-- ì ê³¼ ì…ë ¥ë€ì„ í•˜ë‚˜ì˜ divë¡œ ê°ì‹¸ì„œ ì •ë ¬ -->
                        <div style="display: flex; align-items: center;">
                            <span class="dot" style="color: #fff; font-size: 24px; margin-right: 10px;">&nbsp;&nbsp;â€¢</span>
                            <input type="text" id="PInfoTitle" name="PInfoTitle" placeholder="í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì œëª©#" required
                                   style="border: none; font-size: 24px; padding: 7px; height: 40px; background-color: transparent; outline: none; color: #fff; margin: 0;"/>
                        </div>
                    </div>
                </div>

                <input type="hidden" id="PInfoOwner" name="PInfoOwner" th:value="${session.loginId}" required/><br/>

                <!-- ëª¨ë‹¬ì°½ -->
                <div id="modal-img" class="modal">
                    <div class="modal-content">
                        <span class="close" onclick="closeModal()">&times;</span> <!-- ë‹«ê¸° ë²„íŠ¼ -->
                        <p style="color: #121212; font-size: 18px; font-weight: bold;">í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì»¤ë²„</p><br/><br/>
                        <input type="file" id="PInfoCover" name="PInfoCover" accept="image/*"
                               onchange="previewCoverImage(event)">
                    </div>
                </div>
            </div>
            <hr style="width: 100%; border: 1px solid ghostwhite;"/>
            <div style="width: 100%;">
                <p style="font-size: 15px; margin-top: 0;">+ ë¥¼ ëˆŒëŸ¬ ëª©ë¡ì— ì¶”ê°€í•˜ê¸°</p>
                <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
                    <span id="chartTitle">ğŸ”¥ Hot 100</span> <!-- ì—¬ê¸° í…ìŠ¤íŠ¸ê°€ ë³€ê²½ë  ê²ƒì…ë‹ˆë‹¤ -->
                    <input type="text" id="searchMusic" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥(íƒ€ì´í‹€ë§Œ)">
                    <button id="searchBtn">ê²€ìƒ‰</button>
                    <button type="submit" class="save-button">ìƒì„±</button>
                </div>
            </div>
            <!-- ì¶”ì²œ ìŒì•… ë¦¬ìŠ¤íŠ¸ -->
            <div style="max-height: 400px; overflow-y: auto; scrollbar-width: none;">
                <div id="musicList"></div>
            </div>
        </div>
    </form>
</div>

<!-- í‘¸í„° -->
<div th:replace="~{footer.html}"></div>


<!-- ëª¨ë‹¬ì°½ : ì‚¬ìš©ìê°€ í”Œë ˆì´í•œ ë…¸ë˜ ëª©ë¡ì´ í‘œì‹œë  ê³µê°„ -->
<div class="modal1">
    <div class="modal_form">
        <div class="modal_title">â™ª Recently Played â™ª</div>
        <button id="modal_close"><img src="/img/x.png" width="10" height="10"></button>
        <div class="modal_body">
            <!-- ì—¬ê¸°ì— ì‚¬ìš©ìê°€ í”Œë ˆì´í•œ ë…¸ë˜ ëª©ë¡ì„ ì‚½ì…í•  ì˜ˆì • -->
            <div id="listening-history"></div>
        </div>
        <button id="clear-history-btn">ì „ì²´ ì‚­ì œ</button>
    </div>
</div>

</body>


<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
        crossorigin="anonymous"></script>

<script src="/js/header.js"></script>
<script src="/js/footer.js"></script>
<!--<script src="/js/content.js"></script>-->
<!--<script src="/js/MusicList.js"></script>-->
<script src="/js/PlayList.js"></script>
<script src="/js/musicPlay.js"></script>
<script src="/js/modal_ygm.js"></script>
<script src="/js/sidebar.js"></script>
<script src="/js/mlist.js"></script>

<script>
    $(document).ready(() => {
        // í˜ì´ì§€ ë¡œë”© ì‹œ ì•¨ë²” ëª©ë¡ì„ ìš”ì²­
        $.ajax({
            type: "POST",
            url: "/ChartList",
            dataType: "json",
            success: function (result) {
                console.log(result);
                musicList(result);
            },
            error: function (e) {
                console.log("ì•¨ë²” ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨", e);
                alert('ì•¨ë²” ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨');
            }
        });

        // ë’¤ë¡œê°€ê¸°
        $('#backButton').click(function() {
            window.history.back();
        });
    });


    // Enter í‚¤ê°€ ëˆŒë ¸ì„ ë•Œ searchBtn í´ë¦­ ì´ë²¤íŠ¸ ì‹¤í–‰
    $('#searchMusic').keydown(function(event) {
        // Enter í‚¤ê°€ ëˆŒë ¸ì„ ë•Œ
        if (event.key === 'Enter') {
            event.preventDefault();  // í¼ ì œì¶œ ë°©ì§€

            // #searchBtn í´ë¦­ ì´ë²¤íŠ¸ ê°•ì œ ì‹¤í–‰
            $('#searchBtn').click();
        }
    });

    // #searchBtn í´ë¦­ ì´ë²¤íŠ¸
    $('#searchBtn').click(function(event) {
        event.preventDefault();  // ê¸°ë³¸ í¼ ì œì¶œ ë°©ì§€

        let searchMusic = $('#searchMusic').val();  // ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°

        // AJAX ìš”ì²­
        $.ajax({
            type: "POST",
            url: "/searchM",
            data: { "searchMusic": searchMusic },
            dataType: "json",
            success: (result) => {
                console.log(result);
                musicList(result);  // ê²°ê³¼ ì²˜ë¦¬ í•¨ìˆ˜
            },
            error: () => {
                alert('searchMusic í†µì‹  ì‹¤íŒ¨!');
            }
        });
    });


    function musicList(result) {
        let output = "";
        for (let i in result) {
            output += `<div class="chartBox">
                    <img src="${result[i].malbumCoverName}" alt="ì•¨ë²” ì»¤ë²„">
                    <div class="song-info">
                        <p class="title">${result[i].mtitle}</p>
                        <p class="artist">${result[i].artistName}</p>
                    </div>
                    <div class="actions">
                        <button class="play-image" data-playing="false">
                            <img src="/img/play.png" alt="ì¬ìƒ">
                        </button>
                        <button class="add-to-playlist"
                                data-title="${result[i].mtitle}"
                                data-artist="${result[i].artistName}"
                                data-mid="${result[i].mid}"
                                data-album="${result[i].malbumCoverName}"> <!--ì•¨ë²”ì»¤ë²„ ì‚¬ì§„ ì¶”ê°€-->
                            <img src="/img/plus.png" alt="ì¶”ê°€">
                        </button>
                        <button>
                            <img src="/img/updown.png" alt="ìœ„ì•„ë˜ ë“œë˜ê·¸">
                        </button>
                    </div>
                </div>`;
        }
        $("#musicList").html(output);


        // ë…¸ë˜ ì¶”ê°€ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì„¤ì •
        $(".add-to-playlist").click(function (event) {
            event.preventDefault();  // í¼ ì œì¶œ ë°©ì§€

            const songTitle = $(event.target).data("title");
            const artistName = $(event.target).data("artist");
            const album = $(event.target).data("album");
            const mid = $(event.target).data("mid");  // í´ë¦­ëœ ë…¸ë˜ì˜ mid ê°’ ê°€ì ¸ì˜¤ê¸°

            addToPlaylist(songTitle, artistName, album, mid);  // mid ê°’ë„ í•¨ê»˜ ì „ë‹¬
        });

        // play-image ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        $(".play-image").click(function() {
            // í˜„ì¬ ë²„íŠ¼ì˜ ìƒíƒœë¥¼ í™•ì¸
            let isPlaying = $(this).data("playing");

            if (isPlaying) {
                // í˜„ì¬ ì¬ìƒ ì¤‘ì´ë©´ ì¼ì‹œ ì •ì§€ ì´ë¯¸ì§€ë¡œ ë³€ê²½
                $(this).find("img").attr("src", "/img/play.png");
                $(this).data("playing", false);
            } else {
                // í˜„ì¬ ì •ì§€ ì¤‘ì´ë©´ ì¬ìƒ ì´ë¯¸ì§€ë¡œ ë³€ê²½
                $(this).find("img").attr("src", "/img/stop.png");
                $(this).data("playing", true);
            }
        });
    }

    let midArray = []; // ì„ íƒëœ ë…¸ë˜ì˜ mid ê°’ì„ ì €ì¥í•  ë°°ì—´

    function addToPlaylist(title, artist, album, mid) {
        // ì´ë¯¸ ì¶”ê°€ëœ midì¸ì§€ í™•ì¸
        if (!midArray.includes(mid)) {
            // ì¤‘ë³µë˜ì§€ ì•Šìœ¼ë©´ ë°°ì—´ì— ì¶”ê°€
            midArray.push(mid);

            // ë…¸ë˜ ì •ë³´ ì¶”ê°€
            $("#list").append(`
            <div class="song-item" data-mid="${mid}">
                <img src="${album}" alt="${title} - ${artist} ì•¨ë²” ì»¤ë²„" class="album-cover">
                <div class="song-pinfo">
                    <span class="song-title">${title}</span>
                    <span class="song-artist">${artist}</span>
                </div>
                <button class="remove-song">
                    <img src="/img/x.png" alt="ì‚­ì œ">
                </button>
            </div>
        `);

            // ìˆ¨ê²¨ì§„ inputì— ìƒˆë¡œìš´ mid ê°’ì„ ì¶”ê°€
            $("#list").append(`<input type="hidden" name="mid[]" value="${mid}">`);

            // ì‚­ì œ ë²„íŠ¼ ê¸°ëŠ¥ ì¶”ê°€
            $(".remove-song").last().on("click", function () {
                const songItem = $(this).parent();
                const songMid = songItem.data("mid");

                // ì‚­ì œí•  ë…¸ë˜ì˜ mid ê°’ì„ ë°°ì—´ì—ì„œ ì œê±°
                midArray = midArray.filter(id => id !== songMid);

                // HTML ìš”ì†Œ ì‚­ì œ
                songItem.remove();

                // í•´ë‹¹ hidden inputë„ ì‚­ì œ
                $(`input[name='mid[]'][value='${songMid}']`).remove();
            });
        }
    }


    // ì»¤ë²„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
    function previewCoverImage(event) {
        const file = event.target.files[0];  // ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼
        const preview = document.getElementById('coverPreview');  // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ìš”ì†Œ

        if (file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                preview.src = e.target.result;  // ì—…ë¡œë“œí•œ íŒŒì¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                preview.classList.remove('default');  // ê¸°ë³¸ ì´ë¯¸ì§€ í´ë˜ìŠ¤ë¥¼ ì œê±°
                preview.style.display = 'block';  // ì´ë¯¸ì§€ ë³´ì´ë„ë¡ ì„¤ì •
            };

            reader.readAsDataURL(file);  // íŒŒì¼ì„ ì½ì–´ë“¤ì—¬ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ë¡œ ì„¤ì •
        } else {
            preview.src = 'default.jpg';  // íŒŒì¼ì´ ì—†ë‹¤ë©´ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë˜ëŒë¦¬ê¸°
            preview.classList.add('default');  // ê¸°ë³¸ ì´ë¯¸ì§€ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€
            preview.style.display = 'block';  // ì´ë¯¸ì§€ê°€ ë³´ì´ë„ë¡ ì„¤ì •
        }
    }

    // searchMusic ì…ë ¥ë€ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.getElementById('searchMusic').addEventListener('keydown', function (event) {
        // ì—”í„° í‚¤ê°€ ëˆŒë ¸ì„ ë•Œ
        if (event.key === 'Enter') {
            event.preventDefault();  // í¼ ì œì¶œì„ ë§‰ìŒ
            const searchValue = event.target.value;  // ì…ë ¥ëœ í…ìŠ¤íŠ¸ ê°’
            if (searchValue.trim() !== '') {  // ë¹ˆ ê°’ì´ ì•„ë‹ˆë©´
                document.getElementById('chartTitle').textContent = searchValue;  // ì°¨íŠ¸ ì œëª©ì„ ì…ë ¥ê°’ìœ¼ë¡œ ë³€ê²½
            }
        }
    });

    // searchBtn ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.getElementById('searchBtn').addEventListener('click', function () {
        const searchValue = document.getElementById('searchMusic').value;  // ì…ë ¥ëœ í…ìŠ¤íŠ¸ ê°’
        if (searchValue.trim() !== '') {  // ë¹ˆ ê°’ì´ ì•„ë‹ˆë©´
            document.getElementById('chartTitle').textContent = searchValue;  // ì°¨íŠ¸ ì œëª©ì„ ì…ë ¥ê°’ìœ¼ë¡œ ë³€ê²½
        }
    });


    // ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜
    function openModal() {
        document.getElementById("modal-img").style.display = "flex"; // ëª¨ë‹¬ì„ ë³´ì´ê²Œ ì„¤ì •
    }

    // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
    function closeModal() {
        document.getElementById("modal-img").style.display = "none"; // ëª¨ë‹¬ì„ ìˆ¨ê¸°ê¸°
    }


</script>

</html>
